{
  "id" : "patients",
  "url" : "https://mimic.mit.edu/fhir/mappings/patients",
  "name" : "patients",
  "title" : "Mapping of entries in 'patients' table in MIMIC-IV v2.0 dataset into FHIR Patient resources",
  "source" : [ {
    "alias" : "source",
    "url" : "https://mimic.mit.edu/fhir/StructureDefinition/Ext-patients",
    "joinOn" : [ ]
  } ],
  "context" : { },
  "variable" : [ ],
  "mapping" : [ {
    "expression" : {
      "name" : "patients-mapping",
      "language" : "application/fhir-template+json",
      "value" : {
        "gender" : "{{iif(gender='M', 'male', 'female')}}",
        "birthDate" : "{{(anchor_year - anchor_age)}}",
        "deceasedDateTime" : "{{? dod}}",
        "identifier" : [ {
          "use" : "official",
          "system" : "{{%sourceSystem.sourceUri}}/fhir/subject_ids",
          "value" : "{{subject_id.toString()}}"
        } ],
        "active" : true,
        "id" : "{{mpp:getHashedId('Patient', subject_id.toString())}}",
        "meta" : {
          "source" : "{{%sourceSystem.sourceUri}}",
          "profile" : [ "https://datatools4heart.eu/fhir/StructureDefinition/HFR-Patient" ]
        },
        "extension" : [ {
          "url" : "http://example.org/fhir/StructureDefinition/anchor-year",
          "valueInteger" : "{{anchor_year}}"
        }, {
          "url" : "http://example.org/fhir/StructureDefinition/anchor-year-group",
          "valueString" : "{{anchor_year_group}}"
        } ],
        "resourceType" : "Patient"
      }
    }
  } ]
}