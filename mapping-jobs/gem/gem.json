{
  "id" : "gem",
  "name" : "gem",
  "sourceSettings" : {
    "source" : {
      "jsonClass" : "FileSystemSourceSettings",
      "name" : "gem-source",
      "sourceUri" : "https://datatools4heart.eu/data-ingestion-suite/gem-data",
      "dataFolderPath" : "test-data/gem",
      "asStream" : false
    }
  },
  "sinkSettings" : {
    "jsonClass" : "FhirRepositorySinkSettings",
    "fhirRepoUrl" : "http://localhost:8081/fhir",
    "returnMinimal" : true,
    "errorHandling": "continue"
  },
  "terminologyServiceSettings" : {
    "jsonClass" : "LocalFhirTerminologyServiceSettings",
    "folderPath" : "/terminology-systems/DT4HTerminologyService",
    "conceptMapFiles" : [ {
      "id" : "icd9toicd10.csv",
      "name" : "icd9toicd10.csv",
      "conceptMapUrl" : "https://datatools4heart.eu/fhir/mappings/ConceptMap/icd9-to-icd10",
      "sourceValueSetUrl" : "http://terminology.hl7.org/CodeSystem/icd9cm",
      "targetValueSetUrl" : "http://hl7.org/fhir/sid/icd-10"
    } ],
    "codeSystemFiles" : [ ]
  },
  "mappings" : [ {
    "mappingRef" : "https://datatools4heart.eu/fhir/mappings/gem/patient-mapping",
    "sourceContext" : {
      "source" : {
        "jsonClass" : "FileSystemSource",
        "path" : "angrafica.csv",
        "options" : { }
      }
    }
  }, {
    "mappingRef" : "https://datatools4heart.eu/fhir/mappings/gem/encounter-mapping",
    "sourceContext" : {
      "encounterMain" : {
        "jsonClass" : "FileSystemSource",
        "path" : "elenco_contatti.csv",
        "options" : { }
      },
      "encounterDetails" : {
        "jsonClass" : "FileSystemSource",
        "path" : "dettaglio_contatti.csv",
        "options" : { }
      }
    }
  }, {
    "mappingRef" : "https://datatools4heart.eu/fhir/mappings/gem/lab-result-and-vital-sign-mapping",
    "sourceContext" : {
      "labResults" : {
        "jsonClass" : "FileSystemSource",
        "path" : "diariomisure.csv",
        "options" : { }
      },
      "encounters" : {
        "jsonClass" : "FileSystemSource",
        "path" : "elenco_contatti.csv",
        "options" : { }
      }
    }
  }, {
    "mappingRef" : "https://datatools4heart.eu/fhir/mappings/gem/condition-mapping",
    "sourceContext" : {
      "source" : {
        "jsonClass" : "FileSystemSource",
        "path" : "patologie.csv",
        "options" : { }
      }
    }
  }, {
    "mappingRef" : "https://datatools4heart.eu/fhir/mappings/gem/medication-mapping",
    "sourceContext" : {
      "medications" : {
        "jsonClass" : "FileSystemSource",
        "path" : "farmaci.csv",
        "options" : { }
      },
      "encounters" : {
        "jsonClass" : "FileSystemSource",
        "path" : "elenco_contatti.csv",
        "options" : { }
      }
    }
  }, {
    "mappingRef" : "https://datatools4heart.eu/fhir/mappings/gem/smoking-status-mapping",
    "sourceContext" : {
      "patology" : {
        "jsonClass" : "FileSystemSource",
        "path" : "patologie.csv",
        "options" : { }
      }
    }
  }, {
    "mappingRef" : "https://datatools4heart.eu/fhir/mappings/gem/echocardiograph-mapping",
    "sourceContext" : {
      "echo" : {
        "jsonClass" : "FileSystemSource",
        "path" : "ecocardio.csv",
        "options" : { },
        "preprocessSql" : "SELECT * FROM\n\t(SELECT \n\t\t codice_sanitario, dataerogazione, regexp_replace(concat(mssite, '_', measurename), '[\\\\\\\\W]+', '') as code, measuervalue \n\t FROM echo\n\t)\n\tPIVOT (LAST(measuervalue) as value FOR code in ('FunzioneDiastolica_RapportoEA','FunzioneDiastolica_RapportoEE','FunzioneDiastolica_VelocitPiccoOndaA','FunzioneDiastolica_VelocitPiccoOndaE','Valvolatricuspide_TAPSE','Ventricolosinistro_DiametroDiastolicoIndic','Ventricolosinistro_DiametroSistolicoIndic','Ventricolosinistro_DiametroTeleDiastolico','Ventricolosinistro_DiametroTeleSistolico','Ventricolosinistro_FrazionediEiezione','Ventricolosinistro_ParetePosterioreSpessoreTD','Ventricolosinistro_ParetePosterioreSpessoreTDIndic','Ventricolosinistro_SettoInterventricolareSpessoreTD','Ventricolosinistro_SettointerventricolarespessoreTDIndicM','Ventricolosinistro_StrokeVolumeIndex','Ventricolosinistro_VolumeTeleDiastolico','Ventricolosinistro_VolumeTeleDiastolicoInd','Ventricolosinistro_VolumeTeleSistolico','Ventricolosinistro_VolumeTeleSistolicoInd','Ventricolosinistro_ParetePosterioreSpessoreTS','Ventricolosinistro_ParetePosterioreSpessoreTSIndic','Ventricolodestro_Accorciamentofrazionale','Ventricolosinistro_DiametroInternoTD','FunzioneDiastolica_VelocitPiccoOndaELATTDI','FunzioneDiastolica_VelocitPiccoOndaESETTTDI','Ventricolosinistro_HeartRate','Ventricolosinistro_SettoInterventricolareSpessoreTS','VenaCava_DiametroMax','VenaCava_DiametroMin','Ventricolodestro_DiametroTeleDiastolico','Ventricolodestro_DiametroTeleDiastolicoIndic','VentricolosinistroSettointerventricolarespessoresistolicoIndicM'\n\t))\n"
      },
      "encounters" : {
        "jsonClass" : "FileSystemSource",
        "path" : "elenco_contatti.csv",
        "options" : { }
      }
    }
  }, {
    "mappingRef" : "https://datatools4heart.eu/fhir/mappings/gem/nyha-mapping",
    "sourceContext" : {
      "nyha" : {
        "jsonClass" : "FileSystemSource",
        "path" : "nyha.csv",
        "options" : { }
      },
      "encounters" : {
        "jsonClass" : "FileSystemSource",
        "path" : "elenco_contatti.csv",
        "options" : { }
      }
    }
  }, {
    "mappingRef" : "https://datatools4heart.eu/fhir/mappings/gem/cause-of-death-mapping",
    "sourceContext" : {
      "anagrafica" : {
        "jsonClass" : "FileSystemSource",
        "path" : "angrafica.csv",
        "options" : { }
      }
    }
  } ],
  "mappingErrorHandling" : "continue",
  "useFhirSinkAsIdentityService" : false
}
