{
  "id" : "vhir-deploy",
  "name" : "vhir-deploy",
  "description" : "",
  "sourceSettings" : {
    "vhir-source" : {
      "jsonClass" : "SqlSourceSettings",
      "name" : "vhir-source",
      "sourceUri" : "https://datatools4heart.eu/data-ingestion-suite/vhir-data",
      "databaseUrl" : "jdbc:db2://localhost:50000/testdb",
      "username" : "db2inst1",
      "password" : "vhir-pass"
    }
  },
  "sinkSettings" : {
    "jsonClass" : "FhirRepositorySinkSettings",
    "fhirRepoUrl" : "http://onfhir:8080/fhir",
    "returnMinimal" : true
  },
  "terminologyServiceSettings" : {
    "jsonClass" : "LocalFhirTerminologyServiceSettings",
    "folderPath" : "terminology-systems/DT4HTerminologyService",
    "conceptMapFiles" : [ {
      "id" : "omopToIcd10.csv",
      "name" : "omopToIcd10.csv",
      "conceptMapUrl" : "https://datatools4heart.eu/fhir/mappings/ConceptMap/omop-to-icd10",
      "sourceValueSetUrl" : "https://www.ohdsi.org/omop",
      "targetValueSetUrl" : "http://hl7.org/fhir/sid/icd-10"
    }, {
      "id" : "omopToIcd10Pcs.csv",
      "name" : "omopToIcd10Pcs.csv",
      "conceptMapUrl" : "https://datatools4heart.eu/fhir/mappings/ConceptMap/omop-to-icd10pcs",
      "sourceValueSetUrl" : "https://www.ohdsi.org/omop",
      "targetValueSetUrl" : "http://hl7.org/fhir/sid/icd-10-pcs"
    }, {
      "id" : "ethnicityOmopToSnomed.csv",
      "name" : "ethnicityOmopToSnomed.csv",
      "conceptMapUrl" : "https://datatools4heart.eu/fhir/mappings/ConceptMap/ethnicity-omop-to-snomed",
      "sourceValueSetUrl" : "https://www.ohdsi.org/omop",
      "targetValueSetUrl" : "http://snomed.info/sct"
    }, {
      "id" : "symptomsOmopToSnomed.csv",
      "name" : "symptomsOmopToSnomed.csv",
      "conceptMapUrl" : "https://datatools4heart.eu/fhir/mappings/ConceptMap/symptoms-omop-to-snomed",
      "sourceValueSetUrl" : "https://www.ohdsi.org/omop",
      "targetValueSetUrl" : "http://snomed.info/sct"
    } ],
    "codeSystemFiles" : [ ]
  },
  "mappings" : [ {
    "name" : "cause-of-death-mapping",
    "mappingRef" : "https://datatools4heart.eu/fhir/mappings/vhir/cause-of-death-mapping",
    "sourceBinding" : {
      "omopDeath" : {
        "jsonClass" : "SqlSource",
        "tableName" : "\"0000000004_DT4H\".DEATH",
        "options" : { },
        "sourceRef" : "vhir-source"
      }
    }
  }, {
    "name" : "condition-mapping",
    "mappingRef" : "https://datatools4heart.eu/fhir/mappings/vhir/condition-mapping",
    "sourceBinding" : {
      "omopCondition" : {
        "jsonClass" : "SqlSource",
        "tableName" : "\"0000000004_DT4H\".CONDITION_OCCURRENCE",
        "options" : { },
        "sourceRef" : "vhir-source"
      },
      "omopVisit" : {
        "jsonClass" : "SqlSource",
        "tableName" : "\"0000000004_DT4H\".VISIT_OCCURRENCE",
        "options" : { },
        "sourceRef" : "vhir-source"
      }
    }
  }, {
    "name" : "encounter-mapping",
    "mappingRef" : "https://datatools4heart.eu/fhir/mappings/vhir/encounter-mapping",
    "sourceBinding" : {
      "omopVisitOccurrence" : {
        "jsonClass" : "SqlSource",
        "tableName" : "\"0000000004_DT4H\".VISIT_OCCURRENCE",
        "options" : { },
        "sourceRef" : "vhir-source"
      }
    }
  }, {
    "name" : "medication-mapping",
    "mappingRef" : "https://datatools4heart.eu/fhir/mappings/vhir/medication-mapping",
    "sourceBinding" : {
      "omopDrugExposure" : {
        "jsonClass" : "SqlSource",
        "tableName" : "\"0000000004_DT4H\".DRUG_EXPOSURE",
        "options" : { },
        "sourceRef" : "vhir-source"
      },
      "omopVisit" : {
        "jsonClass" : "SqlSource",
        "tableName" : "\"0000000004_DT4H\".VISIT_OCCURRENCE",
        "options" : { },
        "sourceRef" : "vhir-source"
      }
    }
  }, {
    "name" : "observation-mapping",
    "mappingRef" : "https://datatools4heart.eu/fhir/mappings/vhir/observation-mapping",
    "sourceBinding" : {
      "observation" : {
        "jsonClass" : "SqlSource",
        "tableName" : "\"0000000004_DT4H\".OBSERVATION",
        "options" : { },
        "sourceRef" : "vhir-source"
      },
      "omopVisit" : {
        "jsonClass" : "SqlSource",
        "tableName" : "\"0000000004_DT4H\".VISIT_OCCURRENCE",
        "options" : { },
        "sourceRef" : "vhir-source"
      }
    }
  }, {
    "name" : "patient-mapping",
    "mappingRef" : "https://datatools4heart.eu/fhir/mappings/vhir/patient-mapping",
    "sourceBinding" : {
      "omopPerson" : {
        "jsonClass" : "SqlSource",
        "tableName" : "\"0000000004_DT4H\".PERSON",
        "options" : { },
        "sourceRef" : "vhir-source"
      },
      "omopDeath" : {
        "jsonClass" : "SqlSource",
        "tableName" : "\"0000000004_DT4H\".DEATH",
        "options" : { },
        "sourceRef" : "vhir-source"
      }
    }
  }, {
    "name" : "procedure-mapping",
    "mappingRef" : "https://datatools4heart.eu/fhir/mappings/vhir/procedure-mapping",
    "sourceBinding" : {
      "omopProcedure" : {
        "jsonClass" : "SqlSource",
        "tableName" : "\"0000000004_DT4H\".PROCEDURE_OCCURRENCE",
        "options" : { },
        "sourceRef" : "vhir-source"
      },
      "omopVisit" : {
        "jsonClass" : "SqlSource",
        "tableName" : "\"0000000004_DT4H\".VISIT_OCCURRENCE",
        "options" : { },
        "sourceRef" : "vhir-source"
      }
    }
  }, {
    "name" : "measurement-mapping-2013",
    "mappingRef" : "https://datatools4heart.eu/fhir/mappings/vhir/measurement-mapping",
    "sourceBinding" : {
      "omopMeasurement" : {
        "jsonClass" : "SqlSource",
        "query" : "SELECT * FROM \"0000000004_DT4H\".MEASUREMENT \r\nWHERE EXTRACT(YEAR FROM MEASUREMENT_DATE) = 2013",
        "options" : { },
        "sourceRef" : "vhir-source"
      },
      "omopVisit" : {
        "jsonClass" : "SqlSource",
        "tableName" : "\"0000000004_DT4H\".VISIT_OCCURRENCE",
        "options" : { },
        "sourceRef" : "vhir-source"
      }
    }
  }, {
    "name" : "measurement-mapping-2014",
    "mappingRef" : "https://datatools4heart.eu/fhir/mappings/vhir/measurement-mapping",
    "sourceBinding" : {
      "omopMeasurement" : {
        "jsonClass" : "SqlSource",
        "query" : "SELECT * FROM \"0000000004_DT4H\".MEASUREMENT \r\nWHERE EXTRACT(YEAR FROM MEASUREMENT_DATE) = 2014",
        "options" : { },
        "sourceRef" : "vhir-source"
      },
      "omopVisit" : {
        "jsonClass" : "SqlSource",
        "tableName" : "\"0000000004_DT4H\".VISIT_OCCURRENCE",
        "options" : { },
        "sourceRef" : "vhir-source"
      }
    }
  }, {
    "name" : "measurement-mapping-2015",
    "mappingRef" : "https://datatools4heart.eu/fhir/mappings/vhir/measurement-mapping",
    "sourceBinding" : {
      "omopMeasurement" : {
        "jsonClass" : "SqlSource",
        "query" : "SELECT * FROM \"0000000004_DT4H\".MEASUREMENT \r\nWHERE EXTRACT(YEAR FROM MEASUREMENT_DATE) = 2015",
        "options" : { },
        "sourceRef" : "vhir-source"
      },
      "omopVisit" : {
        "jsonClass" : "SqlSource",
        "tableName" : "\"0000000004_DT4H\".VISIT_OCCURRENCE",
        "options" : { },
        "sourceRef" : "vhir-source"
      }
    }
  }, {
    "name" : "measurement-mapping-2016",
    "mappingRef" : "https://datatools4heart.eu/fhir/mappings/vhir/measurement-mapping",
    "sourceBinding" : {
      "omopMeasurement" : {
        "jsonClass" : "SqlSource",
        "query" : "SELECT * FROM \"0000000004_DT4H\".MEASUREMENT \r\nWHERE EXTRACT(YEAR FROM MEASUREMENT_DATE) = 2016",
        "options" : { },
        "sourceRef" : "vhir-source"
      },
      "omopVisit" : {
        "jsonClass" : "SqlSource",
        "tableName" : "\"0000000004_DT4H\".VISIT_OCCURRENCE",
        "options" : { },
        "sourceRef" : "vhir-source"
      }
    }
  }, {
    "name" : "measurement-mapping-2017",
    "mappingRef" : "https://datatools4heart.eu/fhir/mappings/vhir/measurement-mapping",
    "sourceBinding" : {
      "omopMeasurement" : {
        "jsonClass" : "SqlSource",
        "query" : "SELECT * FROM \"0000000004_DT4H\".MEASUREMENT \r\nWHERE EXTRACT(YEAR FROM MEASUREMENT_DATE) = 2017",
        "options" : { },
        "sourceRef" : "vhir-source"
      },
      "omopVisit" : {
        "jsonClass" : "SqlSource",
        "tableName" : "\"0000000004_DT4H\".VISIT_OCCURRENCE",
        "options" : { },
        "sourceRef" : "vhir-source"
      }
    }
  }, {
    "name" : "measurement-mapping-2018",
    "mappingRef" : "https://datatools4heart.eu/fhir/mappings/vhir/measurement-mapping",
    "sourceBinding" : {
      "omopMeasurement" : {
        "jsonClass" : "SqlSource",
        "query" : "SELECT * FROM \"0000000004_DT4H\".MEASUREMENT \r\nWHERE EXTRACT(YEAR FROM MEASUREMENT_DATE) = 2018",
        "options" : { },
        "sourceRef" : "vhir-source"
      },
      "omopVisit" : {
        "jsonClass" : "SqlSource",
        "tableName" : "\"0000000004_DT4H\".VISIT_OCCURRENCE",
        "options" : { },
        "sourceRef" : "vhir-source"
      }
    }
  }, {
    "name" : "measurement-mapping-2019",
    "mappingRef" : "https://datatools4heart.eu/fhir/mappings/vhir/measurement-mapping",
    "sourceBinding" : {
      "omopMeasurement" : {
        "jsonClass" : "SqlSource",
        "query" : "SELECT * FROM \"0000000004_DT4H\".MEASUREMENT \r\nWHERE EXTRACT(YEAR FROM MEASUREMENT_DATE) = 2019",
        "options" : { },
        "sourceRef" : "vhir-source"
      },
      "omopVisit" : {
        "jsonClass" : "SqlSource",
        "tableName" : "\"0000000004_DT4H\".VISIT_OCCURRENCE",
        "options" : { },
        "sourceRef" : "vhir-source"
      }
    }
  }, {
    "name" : "measurement-mapping-2020",
    "mappingRef" : "https://datatools4heart.eu/fhir/mappings/vhir/measurement-mapping",
    "sourceBinding" : {
      "omopMeasurement" : {
        "jsonClass" : "SqlSource",
        "query" : "SELECT * FROM \"0000000004_DT4H\".MEASUREMENT \r\nWHERE EXTRACT(YEAR FROM MEASUREMENT_DATE) = 2020",
        "options" : { },
        "sourceRef" : "vhir-source"
      },
      "omopVisit" : {
        "jsonClass" : "SqlSource",
        "tableName" : "\"0000000004_DT4H\".VISIT_OCCURRENCE",
        "options" : { },
        "sourceRef" : "vhir-source"
      }
    }
  }, {
    "name" : "measurement-mapping-2021",
    "mappingRef" : "https://datatools4heart.eu/fhir/mappings/vhir/measurement-mapping",
    "sourceBinding" : {
      "omopMeasurement" : {
        "jsonClass" : "SqlSource",
        "query" : "SELECT * FROM \"0000000004_DT4H\".MEASUREMENT \r\nWHERE EXTRACT(YEAR FROM MEASUREMENT_DATE) = 2021",
        "options" : { },
        "sourceRef" : "vhir-source"
      },
      "omopVisit" : {
        "jsonClass" : "SqlSource",
        "tableName" : "\"0000000004_DT4H\".VISIT_OCCURRENCE",
        "options" : { },
        "sourceRef" : "vhir-source"
      }
    }
  }, {
    "name" : "measurement-mapping-2022",
    "mappingRef" : "https://datatools4heart.eu/fhir/mappings/vhir/measurement-mapping",
    "sourceBinding" : {
      "omopMeasurement" : {
        "jsonClass" : "SqlSource",
        "query" : "SELECT * FROM \"0000000004_DT4H\".MEASUREMENT \r\nWHERE EXTRACT(YEAR FROM MEASUREMENT_DATE) = 2022",
        "options" : { },
        "sourceRef" : "vhir-source"
      },
      "omopVisit" : {
        "jsonClass" : "SqlSource",
        "tableName" : "\"0000000004_DT4H\".VISIT_OCCURRENCE",
        "options" : { },
        "sourceRef" : "vhir-source"
      }
    }
  }, {
    "name" : "measurement-mapping-2023",
    "mappingRef" : "https://datatools4heart.eu/fhir/mappings/vhir/measurement-mapping",
    "sourceBinding" : {
      "omopMeasurement" : {
        "jsonClass" : "SqlSource",
        "query" : "SELECT * FROM \"0000000004_DT4H\".MEASUREMENT \r\nWHERE EXTRACT(YEAR FROM MEASUREMENT_DATE) = 2023",
        "options" : { },
        "sourceRef" : "vhir-source"
      },
      "omopVisit" : {
        "jsonClass" : "SqlSource",
        "tableName" : "\"0000000004_DT4H\".VISIT_OCCURRENCE",
        "options" : { },
        "sourceRef" : "vhir-source"
      }
    }
  }, {
    "name" : "measurement-mapping-2024",
    "mappingRef" : "https://datatools4heart.eu/fhir/mappings/vhir/measurement-mapping",
    "sourceBinding" : {
      "omopMeasurement" : {
        "jsonClass" : "SqlSource",
        "query" : "SELECT * FROM \"0000000004_DT4H\".MEASUREMENT \r\nWHERE EXTRACT(YEAR FROM MEASUREMENT_DATE) = 2024",
        "options" : { },
        "sourceRef" : "vhir-source"
      },
      "omopVisit" : {
        "jsonClass" : "SqlSource",
        "tableName" : "\"0000000004_DT4H\".VISIT_OCCURRENCE",
        "options" : { },
        "sourceRef" : "vhir-source"
      }
    }
  }, {
    "name" : "measurement-mapping-2025",
    "mappingRef" : "https://datatools4heart.eu/fhir/mappings/vhir/measurement-mapping",
    "sourceBinding" : {
      "omopMeasurement" : {
        "jsonClass" : "SqlSource",
        "query" : "SELECT * FROM \"0000000004_DT4H\".MEASUREMENT \r\nWHERE EXTRACT(YEAR FROM MEASUREMENT_DATE) = 2025",
        "options" : { },
        "sourceRef" : "vhir-source"
      },
      "omopVisit" : {
        "jsonClass" : "SqlSource",
        "tableName" : "\"0000000004_DT4H\".VISIT_OCCURRENCE",
        "options" : { },
        "sourceRef" : "vhir-source"
      }
    }
  }, {
    "name" : "echo-mapping",
    "mappingRef" : "https://datatools4heart.eu/fhir/mappings/vhir/echo-mapping",
    "sourceBinding" : {
      "omopMeasurement" : {
        "jsonClass" : "SqlSource",
        "query" : "select * from \"0000000004_DT4H\".\"MEASUREMENT_ECHOCARDIO\"\r\nwhere MEASUREMENT_CONCEPT_ID != 4177340 and MEASUREMENT_CONCEPT_ID != 4099154",
        "options" : { },
        "preprocessSql" : "select count(*) as count, PERSON_ID, MEASUREMENT_ID, MEASUREMENT_DATE,\r\narray_agg(MEASUREMENT_CONCEPT_ID) as MEASUREMENT_CONCEPT_ID,\r\narray_agg(VALUE_AS_NUMBER) as VALUE_AS_NUMBER,\r\narray_agg(UNIT_CONCEPT_ID) as UNIT_CONCEPT_ID,\r\narray_agg(UNIT_SOURCE_VALUE) as UNIT_SOURCE_VALUE\r\nfrom omopMeasurement \r\ngroup by PERSON_ID, MEASUREMENT_ID, MEASUREMENT_DATE",
        "sourceRef" : "vhir-source"
      },
      "omopVisit" : {
        "jsonClass" : "SqlSource",
        "tableName" : "\"0000000004_DT4H\".VISIT_OCCURRENCE",
        "options" : { },
        "sourceRef" : "vhir-source"
      }
    }
  }, {
    "name" : "echo-weight-height-mapping",
    "mappingRef" : "https://datatools4heart.eu/fhir/mappings/vhir/echo-weight-height-mapping",
    "sourceBinding" : {
      "omopMeasurement" : {
        "jsonClass" : "SqlSource",
        "query" : "select * from \"0000000004_DT4H\".\"MEASUREMENT_ECHOCARDIO\"\r\nwhere MEASUREMENT_CONCEPT_ID = 4177340 or MEASUREMENT_CONCEPT_ID = 4099154",
        "options" : { },
        "sourceRef" : "vhir-source"
      },
      "omopVisit" : {
        "jsonClass" : "SqlSource",
        "tableName" : "\"0000000004_DT4H\".VISIT_OCCURRENCE",
        "options" : { },
        "sourceRef" : "vhir-source"
      }
    }
  } ],
  "dataProcessingSettings" : {
    "saveErroneousRecords" : false,
    "archiveMode" : "off"
  },
  "useFhirSinkAsIdentityService" : false
}